{% from "./../popover/component.njk" import popover %}
{% from "./../menu/component.njk" import menu %}
{% from "./../input-group/component.njk" import input_group %}
{% from "../button/component.njk" import button %}
{% import "../forms.njk" as forms %}
{% import "./../utils.njk" as utils %}

{#
<!--
search_input:
  properties={
    "value": "Sear",
    "placeholder": "Search products",
    "collapsable": false,
    "collapsed": false,
    "items": [
      {
        "label": "<strong>Sear</strong>ch Result A",
        "action": "#"
      },
      {
        "label": "<strong>Sear</strong>ch Result B",
        "action": "#"
      },
      {
        "label": "<strong>Sear</strong>ch Result C",
        "action": "#"
      },
      {
        "label": "<strong>Sear</strong>ch Result D",
        "action": "#"
      }
    ]
  },
  modifier={ block: [] },
  state={},
  aria={}
-->
#}

{% macro search_input(
    properties={},
    modifier={},
    state={},
    aria={})
-%}
  {%- set _id = utils.id() %}
  {%- set _inputid = utils.id() %}

  <div class="fd-search-input{{ classes|classes }} {%- if properties.collapsed == true %} is-collapsed{%- endif %} {%- if properties.collapsable == true %} fd-search-input--collapsable{%- endif %} {{ modifier.block | modifier('search-input') }}">

      <div class="fd-popover">

          <div class="fd-popover__control">

              {%- if properties.collapsable == true %}

                <div class="fd-search-input__control">
                  <div class="fd-input-group fd-input-group--after">
                    <input type="text" class="fd-input" id="{{ _inputid }}" placeholder="{{ properties.placeholder }}" value="{{ properties.value }}" aria-controls="{{ _id }}" aria-expanded="false" aria-haspopup="true">

                    <span class="fd-input-group__addon fd-input-group__addon--after fd-input-group__addon--button ">
                      <button class=" fd-button--light sap-icon--search"></button>
                    </span>
                  </div>
                </div>

              {% else %}

                <div class="fd-search-input__control" aria-controls="{{ _id }}" aria-expanded="false" aria-haspopup="true">
                  <div class="fd-input-group fd-input-group--after">
                    <input type="text" class="fd-input" id="{{ _inputid }}" placeholder="{{ properties.placeholder }}" value="{{ properties.value }}">

                    <span class="fd-input-group__addon fd-input-group__addon--after fd-input-group__addon--button ">
                      <button class=" fd-button--light sap-icon--search"></button>
                    </span>
                  </div>
                </div>

              {%- endif %}

          </div>

          <div class="fd-popover__body fd-search-input__body fd-popover__body--no-arrow" aria-hidden="true" id="{{_id}}">
              {{ search_input_body(properties={ "items": properties.items }) }}
          </div>
      </div>

  </div>
{%- endmacro %}

{%- macro search_input_body(properties={}, modifier={}, state={}) -%}

  <nav class="fd-menu">
      <ul class="fd-menu__list">
          {% for item in properties.items %}
            <li><a href="{{ item.action }}" class="fd-menu__item">{{ item.label }}</a></li>
          {% endfor %}
      </ul>
  </nav>

{%- endmacro -%}
